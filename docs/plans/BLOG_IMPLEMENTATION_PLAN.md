# План реализации блога (гибридный подход)

## Обзор архитектуры

### Структура файлов
```
blog/
├── articles.json              # Метаданные всех статей
├── posts/                     # HTML файлы статей
│   ├── 2024-12-15-telegram-ecosystems.html
│   ├── 2024-12-20-production-essentials.html
│   └── 2024-12-25-logs-metrics.html
└── assets/                    # Изображения для статей
    └── ...

js/
├── blog.js                    # Модуль для работы со списком статей
└── article.js                 # Модуль для работы с отдельной статьей

css/
└── blog.css                   # Стили для блога (или расширить components.css)

scripts/
├── validate-blog.js          # Валидация структуры блога
└── add-article.js            # Утилита для добавления новых статей
```

---

## Этап 1: Базовая структура и данные

### 1.1 Создать структуру папок
- [ ] Создать `blog/posts/` для HTML файлов статей
- [ ] Создать `blog/assets/` для изображений статей
- [ ] Создать `scripts/` для утилит

### 1.2 Создать `blog/articles.json`
Структура данных:
```json
{
  "articles": [
    {
      "id": "telegram-ecosystems",
      "title": "Как я проектирую Telegram‑экосистемы",
      "date": "2024-12-15",
      "tags": ["telegram", "архитектура", "python"],
      "excerpt": "Краткое описание статьи...",
      "contentFile": "blog/posts/2024-12-15-telegram-ecosystems.html",
      "status": "published",  // "published" | "draft"
      "readTime": 5,  // минуты чтения
      "icon": "icon-robot.svg"
    }
  ]
}
```

**Поля:**
- `id` - уникальный идентификатор (slug)
- `title` - заголовок статьи
- `date` - дата публикации (YYYY-MM-DD)
- `tags` - массив тегов
- `excerpt` - краткое описание (150-200 символов)
- `contentFile` - путь к HTML файлу статьи
- `status` - статус публикации
- `readTime` - примерное время чтения в минутах
- `icon` - иконка для карточки (из assets/icons/)

---

## Этап 2: JavaScript модули

### 2.1 `js/blog.js` - Модуль списка статей

**Функционал:**
1. Загрузка `articles.json`
2. Фильтрация статей по статусу (показывать только published)
3. Рендеринг списка статей в контейнер
4. Сортировка по дате (новые сверху)
5. Фильтрация по тегам
6. Поиск по заголовку и тегам
7. Кэширование в localStorage

**API модуля:**
```javascript
BlogManager.init(containerSelector)
BlogManager.filterByTag(tag)
BlogManager.search(query)
BlogManager.sortByDate(order) // 'desc' | 'asc'
```

**Рендеринг карточки статьи:**
- Иконка
- Заголовок
- Дата публикации
- Теги
- Краткое описание
- Время чтения
- Ссылка на статью

### 2.2 `js/article.js` - Модуль отдельной статьи

**Функционал:**
1. Загрузка HTML файла статьи
2. Извлечение метаданных из `<head>` (если есть)
3. Отображение статьи с правильной типографикой
4. Навигация: Предыдущая/Следующая статья
5. Связанные статьи (по тегам)
6. Кнопка "Назад к блогу"

**Метаданные в HTML статье:**
```html
<head>
  <meta name="article-id" content="telegram-ecosystems">
  <meta name="article-date" content="2024-12-15">
  <meta name="article-tags" content="telegram,архитектура,python">
  <meta name="article-read-time" content="5">
</head>
```

---

## Этап 3: HTML и стили

### 3.1 Обновить `blog.html`

**Структура:**
- Hero секция (как сейчас)
- Секция фильтров (теги, поиск)
- Контейнер для списка статей (`<div id="articles-list">`)
- Секция "Статьи в работе" (draft статус)

**Фильтры:**
- Поисковая строка
- Облако тегов (кликабельные)
- Сортировка (по дате)

### 3.2 Создать `blog/post-template.html`

**Структура:**
- Header (как в blog.html)
- Hero секция статьи (заголовок, дата, теги, время чтения)
- Контент статьи (`<article>`)
- Навигация (Предыдущая/Следующая)
- Связанные статьи
- Footer (контакты)

### 3.3 CSS стили (`css/blog.css`)

**Стили для списка статей:**
- `.articles-grid` - сетка статей
- `.article-card` - карточка статьи
- `.article-meta` - метаданные (дата, теги, время чтения)
- `.article-tags` - теги статьи
- `.tag` - отдельный тег

**Стили для страницы статьи:**
- `.article-header` - заголовок статьи
- `.article-content` - контент статьи
- `.article-content h1-h6` - заголовки
- `.article-content code` - код
- `.article-content pre` - блоки кода
- `.article-content blockquote` - цитаты
- `.article-content img` - изображения
- `.article-navigation` - навигация между статьями
- `.related-articles` - связанные статьи

**Адаптивность:**
- Мобильная версия (1 колонка)
- Планшет (2 колонки)
- Десктоп (3 колонки для списка)

---

## Этап 4: Утилиты и инструменты

### 4.1 `scripts/validate-blog.js` / `validate-blog.cmd`

**Проверки:**
1. Валидность JSON структуры
2. Все обязательные поля присутствуют
3. Даты в правильном формате (YYYY-MM-DD)
4. Файлы статей существуют
5. Нет дублирующихся ID
6. Теги не пустые
7. Excerpt не превышает 300 символов

**Вывод:**
- Список ошибок
- Предупреждения
- Статистика (всего статей, опубликовано, черновиков)

### 4.2 `scripts/add-article.js` / `add-article.cmd`

**Функционал:**
1. Интерактивный ввод данных статьи
2. Генерация ID из заголовка (slug)
3. Создание HTML файла статьи из шаблона
4. Добавление записи в `articles.json`
5. Валидация перед сохранением

**Ввод данных:**
- Заголовок
- Дата (по умолчанию сегодня)
- Теги (через запятую)
- Краткое описание
- Статус (published/draft)
- Иконка

---

## Этап 5: Миграция существующих данных

### 5.1 Мигрировать статьи из blog.html

**Статьи в работе:**
1. "Как я проектирую Telegram‑экосистемы"
2. "Что считаю обязательным в продовом сервисе"
3. "Как я подхожу к логам и метрикам"

**Действия:**
1. Создать HTML файлы для каждой статьи
2. Добавить в `articles.json` со статусом `draft`
3. Обновить `blog.html` для использования новой системы

---

## Этап 6: Дополнительные функции

### 6.1 Поиск по статьям
- Поисковая строка в `blog.html`
- Поиск по заголовку, тегам, excerpt
- Подсветка результатов

### 6.2 Навигация между статьями
- Кнопки "Предыдущая статья" / "Следующая статья"
- На основе даты публикации

### 6.3 Связанные статьи
- Показывать статьи с общими тегами
- Максимум 3-4 статьи
- Внизу страницы статьи

### 6.4 Оптимизация
- Ленивая загрузка изображений (`loading="lazy"`)
- Кэширование `articles.json` в localStorage
- Предзагрузка следующей статьи (опционально)

---

## Этап 7: Тестирование и документация

### 7.1 Тестирование
- [ ] Проверка загрузки списка статей
- [ ] Проверка фильтрации по тегам
- [ ] Проверка поиска
- [ ] Проверка загрузки отдельной статьи
- [ ] Проверка навигации между статьями
- [ ] Проверка адаптивности
- [ ] Проверка валидации JSON
- [ ] Проверка утилиты добавления статьи

### 7.2 Документация
- [ ] README для блога (как добавлять статьи)
- [ ] Комментарии в коде
- [ ] Примеры использования API

---

## Порядок реализации (рекомендуемый)

1. **Этап 1** - Базовая структура и данные
2. **Этап 3.1** - Обновить blog.html (базовая структура)
3. **Этап 3.3** - CSS стили для списка статей
4. **Этап 2.1** - js/blog.js (базовый рендеринг списка)
5. **Этап 2.1** - Расширить blog.js (фильтры, поиск)
6. **Этап 3.2** - Создать шаблон статьи
7. **Этап 3.3** - CSS стили для статьи
8. **Этап 2.2** - js/article.js
9. **Этап 4** - Утилиты
10. **Этап 5** - Миграция данных
11. **Этап 6** - Дополнительные функции
12. **Этап 7** - Тестирование

---

## Технические детали

### Формат HTML статьи

```html
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Заголовок статьи - Moon</title>
    
    <!-- Метаданные статьи -->
    <meta name="article-id" content="article-id">
    <meta name="article-date" content="2024-12-15">
    <meta name="article-tags" content="tag1,tag2,tag3">
    <meta name="article-read-time" content="5">
    
    <!-- CSS -->
    <link rel="stylesheet" href="../css/main.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/blog.css">
    
    <!-- Шрифты -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header class="header">...</header>
    
    <!-- Article -->
    <article class="article-content">
        <h1>Заголовок статьи</h1>
        <!-- Контент статьи -->
    </article>
    
    <!-- Navigation -->
    <nav class="article-navigation">...</nav>
    
    <!-- Related Articles -->
    <section class="related-articles">...</section>
    
    <!-- Footer -->
    <footer>...</footer>
    
    <script src="../js/main.js"></script>
    <script src="../js/article.js"></script>
</body>
</html>
```

### Маршрутизация статей

**Вариант:** Отдельные HTML файлы
- `blog/posts/2024-12-15-telegram-ecosystems.html`
- URL: `blog/posts/telegram-ecosystems.html` (можно использовать rewrite)

**Альтернатива:** Один файл с параметром
- `blog/article.html?id=telegram-ecosystems`
- Загрузка контента через AJAX

**Рекомендация:** Отдельные HTML файлы (лучше для SEO)

---

## Заметки

- Все статьи хранятся в `blog/posts/`
- Метаданные в `blog/articles.json`
- Изображения в `blog/assets/`
- Использовать существующие стили из `components.css` где возможно
- Поддержка темной темы (как на основном сайте)
- Анимации при загрузке статей (fade-in)

